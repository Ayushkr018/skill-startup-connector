<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messages - SkillSync AI</title>
    <meta name="description" content="Real-time messaging system for SkillSync AI - Connect with candidates and startups instantly.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/icons/favicon.ico">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="responsive.css">
    
    <!-- Chat-specific CSS -->
    <style>
        /* Chat Variables */
        :root {
            --chat-bg: #F8FAFC;
            --chat-sidebar-bg: #FFFFFF;
            --chat-main-bg: #FFFFFF;
            --chat-input-bg: #F7FAFC;
            --chat-border: #E2E8F0;
            --chat-text: #1A202C;
            --chat-text-light: #64748B;
            --message-sent-bg: #2196F3;
            --message-received-bg: #F1F5F9;
        }

        /* Chat Body */
        .chat-body {
            background: var(--chat-bg);
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
        }

        /* Chat Header */
        .chat-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: white;
            border-bottom: 1px solid var(--chat-border);
            z-index: 1000;
            display: flex;
            align-items: center;
            padding: 0 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .chat-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        .chat-logo a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.25rem;
        }

        .chat-logo a:hover {
            color: var(--primary-dark);
        }

        .chat-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--chat-text);
            margin: 0;
        }

        .chat-header-actions {
            display: flex;
            gap: 1rem;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border: 1px solid var(--chat-border);
            border-radius: 50%;
            background: white;
            color: var(--chat-text-light);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        /* Chat Layout */
        .chat-layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            height: calc(100vh - 80px);
            margin-top: 80px;
        }

        /* Chat Sidebar */
        .chat-sidebar {
            background: var(--chat-sidebar-bg);
            border-right: 1px solid var(--chat-border);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--chat-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-sidebar-header h2 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--chat-text);
            margin: 0;
        }

        .btn-new-chat {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-new-chat:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* Conversation List */
        .conversation-list {
            flex: 1;
            overflow-y: auto;
        }

        .conversation-item {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #F7FAFC;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
        }

        .conversation-item:hover {
            background: #F7FAFC;
        }

        .conversation-item.active {
            background: var(--primary-color);
            color: white;
        }

        .conversation-item.active * {
            color: white !important;
        }

        .conversation-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .conversation-details {
            flex: 1;
            min-width: 0;
        }

        .conversation-name {
            font-weight: 600;
            color: var(--chat-text);
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }

        .conversation-preview {
            color: var(--chat-text-light);
            font-size: 0.85rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 0.25rem;
        }

        .conversation-time {
            color: var(--chat-text-light);
            font-size: 0.75rem;
        }

        .conversation-status {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.25rem;
        }

        .unread-badge {
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .online-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-color);
        }

        /* Chat Main */
        .chat-main {
            display: flex;
            flex-direction: column;
            background: var(--chat-main-bg);
        }

        .chat-contact-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--chat-border);
            background: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-contact {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .contact-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .contact-info {
            flex: 1;
        }

        .contact-name {
            font-weight: 600;
            color: var(--chat-text);
            margin-bottom: 0.25rem;
        }

        .contact-status {
            color: var(--chat-text-light);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-online {
            color: var(--success-color);
        }

        .chat-actions {
            display: flex;
            gap: 0.75rem;
        }

        /* Chat Messages */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            background: #FAFBFC;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message-bubble {
            max-width: 80%;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            position: relative;
            animation: messageSlideIn 0.3s ease;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-bubble.sent {
            background: var(--message-sent-bg);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .message-bubble.received {
            background: var(--message-received-bg);
            color: var(--chat-text);
            border: 1px solid var(--chat-border);
            border-bottom-left-radius: 4px;
        }

        .message-content {
            margin-bottom: 0.25rem;
            line-height: 1.4;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        .message-bubble.sent .message-time {
            color: rgba(255, 255, 255, 0.8);
        }

        .message-bubble.received .message-time {
            color: var(--chat-text-light);
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            max-width: 80px;
            background: var(--message-received-bg);
            border: 1px solid var(--chat-border);
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            border-bottom-left-radius: 4px;
        }

        .typing-dots {
            display: flex;
            gap: 2px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--chat-text-light);
            animation: typingDot 1.4s infinite;
        }

        .typing-dot:nth-child(1) { animation-delay: 0ms; }
        .typing-dot:nth-child(2) { animation-delay: 200ms; }
        .typing-dot:nth-child(3) { animation-delay: 400ms; }

        @keyframes typingDot {
            0%, 60%, 100% {
                transform: scale(1);
                opacity: 0.4;
            }
            30% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        /* Chat Input */
        .chat-input-area {
            padding: 1.5rem;
            border-top: 1px solid var(--chat-border);
            background: white;
        }

        .chat-input {
            display: flex;
            gap: 0.75rem;
            align-items: flex-end;
        }

        .chat-input-group {
            flex: 1;
            position: relative;
        }

        .chat-input input {
            width: 100%;
            padding: 0.75rem 3rem 0.75rem 1rem;
            border: 1px solid var(--chat-border);
            border-radius: 2rem;
            outline: none;
            font-size: 0.95rem;
            resize: none;
            font-family: inherit;
            background: var(--chat-input-bg);
            transition: all 0.2s ease;
        }

        .chat-input input:focus {
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .input-actions {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 0.5rem;
        }

        .input-action-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 50%;
            background: none;
            color: var(--chat-text-light);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .input-action-btn:hover {
            background: #F1F5F9;
            color: var(--primary-color);
        }

        .btn-send {
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-send:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .btn-send:disabled {
            background: var(--chat-border);
            cursor: not-allowed;
            transform: none;
        }

        /* Empty State */
        .chat-empty-state {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--chat-text-light);
            text-align: center;
            padding: 2rem;
        }

        .chat-empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .chat-empty-state h3 {
            font-size: 1.25rem;
            color: var(--chat-text);
            margin-bottom: 0.5rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .chat-layout {
                grid-template-columns: 1fr;
                position: relative;
            }
            
            .chat-sidebar {
                position: absolute;
                left: -100%;
                top: 0;
                width: 320px;
                height: 100%;
                transition: left 0.3s ease;
                z-index: 1001;
                box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            }
            
            .chat-sidebar.open {
                left: 0;
            }
            
            .chat-main {
                grid-column: 1;
            }
            
            .mobile-back-btn {
                display: flex;
            }
            
            .chat-header-actions {
                gap: 0.5rem;
            }
            
            .btn-icon {
                width: 36px;
                height: 36px;
            }
        }

        .mobile-back-btn {
            display: none;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        /* Message status indicators */
        .message-status {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 0.25rem;
            margin-top: 0.25rem;
        }

        .status-icon {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        .status-sent { color: rgba(255, 255, 255, 0.6); }
        .status-delivered { color: rgba(255, 255, 255, 0.8); }
        .status-read { color: #4CAF50; }
    </style>
</head>
<body class="chat-body">
    <!-- Chat Header -->
    <header class="chat-header">
        <div class="chat-header-content">
            <div class="mobile-back-btn">
                <a href="student-dashboard.html">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back</span>
                </a>
            </div>
            <div class="chat-logo">
                <a href="index.html">
                    <i class="fas fa-network-wired"></i>
                    <span>SkillSync AI</span>
                </a>
            </div>
            <h1 class="chat-title">Messages</h1>
            <div class="chat-header-actions">
                <button class="btn-icon" onclick="toggleChatSidebar()" title="Toggle Conversations">
                    <i class="fas fa-bars"></i>
                </button>
                <button class="btn-icon" onclick="searchMessages()" title="Search Messages">
                    <i class="fas fa-search"></i>
                </button>
                <button class="btn-icon" onclick="openChatSettings()" title="Chat Settings">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Chat Layout -->
    <div class="chat-layout">
        <!-- Chat Sidebar -->
        <div class="chat-sidebar" id="chatSidebar">
            <div class="chat-sidebar-header">
                <h2>Conversations</h2>
                <button class="btn-new-chat" onclick="startNewChat()" title="Start New Chat">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
            
            <div class="conversation-list">
                <div class="conversation-item active" data-chat-id="1" onclick="selectConversation(1, this)">
                    <div class="conversation-avatar">
                        <span>T</span>
                    </div>
                    <div class="conversation-details">
                        <div class="conversation-name">TechStart Inc.</div>
                        <div class="conversation-preview">Great! When can you start?</div>
                        <div class="conversation-time">2 min ago</div>
                    </div>
                    <div class="conversation-status">
                        <div class="unread-badge">2</div>
                        <div class="online-indicator"></div>
                    </div>
                </div>
                
                <div class="conversation-item" data-chat-id="2" onclick="selectConversation(2, this)">
                    <div class="conversation-avatar">
                        <span>D</span>
                    </div>
                    <div class="conversation-details">
                        <div class="conversation-name">DesignCorp</div>
                        <div class="conversation-preview">We'd like to schedule an interview</div>
                        <div class="conversation-time">1 hour ago</div>
                    </div>
                    <div class="conversation-status">
                        <div class="online-indicator"></div>
                    </div>
                </div>
                
                <div class="conversation-item" data-chat-id="3" onclick="selectConversation(3, this)">
                    <div class="conversation-avatar">
                        <span>A</span>
                    </div>
                    <div class="conversation-details">
                        <div class="conversation-name">AI Innovations</div>
                        <div class="conversation-preview">Your profile looks impressive!</div>
                        <div class="conversation-time">Yesterday</div>
                    </div>
                </div>

                <div class="conversation-item" data-chat-id="4" onclick="selectConversation(4, this)">
                    <div class="conversation-avatar">
                        <span>S</span>
                    </div>
                    <div class="conversation-details">
                        <div class="conversation-name">StartupHub</div>
                        <div class="conversation-preview">Thanks for your application</div>
                        <div class="conversation-time">2 days ago</div>
                    </div>
                </div>

                <div class="conversation-item" data-chat-id="5" onclick="selectConversation(5, this)">
                    <div class="conversation-avatar">
                        <span>F</span>
                    </div>
                    <div class="conversation-details">
                        <div class="conversation-name">FinTech Solutions</div>
                        <div class="conversation-preview">Let's discuss the project details</div>
                        <div class="conversation-time">3 days ago</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Main -->
        <div class="chat-main" id="chatMain">
            <div class="chat-contact-header">
                <div class="chat-contact">
                    <div class="contact-avatar">
                        <span id="contactAvatar">T</span>
                    </div>
                    <div class="contact-info">
                        <div class="contact-name" id="contactName">TechStart Inc.</div>
                        <div class="contact-status">
                            <span class="status-online">‚óè Online</span>
                            <span>‚Ä¢ HR Manager</span>
                        </div>
                    </div>
                </div>
                <div class="chat-actions">
                    <button class="btn-icon" onclick="startVoiceCall()" title="Voice Call">
                        <i class="fas fa-phone"></i>
                    </button>
                    <button class="btn-icon" onclick="startVideoCall()" title="Video Call">
                        <i class="fas fa-video"></i>
                    </button>
                    <button class="btn-icon" onclick="showChatInfo()" title="Chat Info">
                        <i class="fas fa-info-circle"></i>
                    </button>
                </div>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message-bubble received">
                    <div class="message-content">
                        Hi Ayush! We reviewed your profile and we're very impressed with your skills.
                    </div>
                    <div class="message-time">Today 2:30 PM</div>
                </div>
                
                <div class="message-bubble received">
                    <div class="message-content">
                        Would you be interested in a Full Stack Developer position at our company?
                    </div>
                    <div class="message-time">Today 2:31 PM</div>
                </div>
                
                <div class="message-bubble sent">
                    <div class="message-content">
                        Hi! Thank you for reaching out. Yes, I'm definitely interested!
                    </div>
                    <div class="message-time">Today 2:45 PM</div>
                    <div class="message-status">
                        <i class="fas fa-check-double status-read" title="Read"></i>
                    </div>
                </div>
                
                <div class="message-bubble sent">
                    <div class="message-content">
                        Could you tell me more about the role and your tech stack?
                    </div>
                    <div class="message-time">Today 2:46 PM</div>
                    <div class="message-status">
                        <i class="fas fa-check-double status-read" title="Read"></i>
                    </div>
                </div>
                
                <div class="message-bubble received">
                    <div class="message-content">
                        Of course! We're working with React, Node.js, and AWS. The role involves both frontend and backend development.
                    </div>
                    <div class="message-time">Today 3:15 PM</div>
                </div>
                
                <div class="message-bubble received">
                    <div class="message-content">
                        The salary range is ‚Çπ80k-120k per month based on experience. We also offer equity and flexible working hours.
                    </div>
                    <div class="message-time">Today 3:16 PM</div>
                </div>

                <div class="message-bubble sent">
                    <div class="message-content">
                        That sounds amazing! I have 3+ years of experience with React and Node.js. When can we schedule a call?
                    </div>
                    <div class="message-time">Today 3:18 PM</div>
                    <div class="message-status">
                        <i class="fas fa-check-double status-delivered" title="Delivered"></i>
                    </div>
                </div>

                <div class="message-bubble received">
                    <div class="message-content">
                        Perfect! How about tomorrow at 3 PM? I'll send you a calendar invite.
                    </div>
                    <div class="message-time">Today 3:20 PM</div>
                </div>

                <!-- Typing Indicator (initially hidden) -->
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            </div>

            <div class="chat-input-area">
                <div class="chat-input">
                    <div class="chat-input-group">
                        <input type="text" placeholder="Type a message..." id="messageInput" autocomplete="off">
                        <div class="input-actions">
                            <button class="input-action-btn" onclick="attachFile()" title="Attach File">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <button class="input-action-btn" onclick="addEmoji()" title="Add Emoji">
                                <i class="fas fa-smile"></i>
                            </button>
                        </div>
                    </div>
                    <button class="btn-send" id="sendButton" onclick="sendMessage()" title="Send Message">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Global chat state
        let currentChatId = 1;
        let isTyping = false;
        let typingTimeout = null;
        let chatSidebarOpen = false;

        // Chat data
        const chatData = {
            1: {
                name: "TechStart Inc.",
                avatar: "T",
                status: "Online ‚Ä¢ HR Manager",
                messages: [] // Messages are already in DOM for demo
            },
            2: {
                name: "DesignCorp",
                avatar: "D", 
                status: "Online ‚Ä¢ Design Lead",
                messages: []
            },
            3: {
                name: "AI Innovations",
                avatar: "A",
                status: "Away ‚Ä¢ CTO",
                messages: []
            },
            4: {
                name: "StartupHub",
                avatar: "S",
                status: "Offline ‚Ä¢ Last seen 2 hours ago",
                messages: []
            },
            5: {
                name: "FinTech Solutions",
                avatar: "F",
                status: "Online ‚Ä¢ Product Manager",
                messages: []
            }
        };

        // Initialize chat
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üí¨ Chat Interface Loaded');
            setupChatFunctionality();
            loadChatData();
        });

        function setupChatFunctionality() {
            const messageInput = document.getElementById('messageInput');
            const sendButton = document.getElementById('sendButton');
            const chatMessages = document.getElementById('chatMessages');

            // Send message on Enter key
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Show typing indicator
            messageInput.addEventListener('input', function() {
                handleTyping();
            });

            // Auto-scroll to bottom
            scrollToBottom();

            // Enable send button only when there's text
            messageInput.addEventListener('input', function() {
                const hasText = this.value.trim().length > 0;
                sendButton.disabled = !hasText;
                sendButton.style.opacity = hasText ? '1' : '0.5';
            });

            // Initialize send button state
            sendButton.disabled = true;
            sendButton.style.opacity = '0.5';
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const messageText = messageInput.value.trim();
            
            if (messageText) {
                addMessage(messageText, true);
                messageInput.value = '';
                
                // Reset send button
                const sendButton = document.getElementById('sendButton');
                sendButton.disabled = true;
                sendButton.style.opacity = '0.5';
                
                // Simulate typing response
                showTypingIndicator();
                
                setTimeout(() => {
                    hideTypingIndicator();
                    simulateResponse(messageText);
                }, 1000 + Math.random() * 2000);
                
                // Update conversation preview
                updateConversationPreview(currentChatId, messageText);
            }
        }

        function addMessage(text, isSent) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-bubble ${isSent ? 'sent' : 'received'}`;
            
            const now = new Date();
            const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            messageDiv.innerHTML = `
                <div class="message-content">${escapeHtml(text)}</div>
                <div class="message-time">Today ${timeString}</div>
                ${isSent ? '<div class="message-status"><i class="fas fa-check status-sent" title="Sent"></i></div>' : ''}
            `;
            
            // Insert before typing indicator if it exists
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator && typingIndicator.style.display !== 'none') {
                chatMessages.insertBefore(messageDiv, typingIndicator);
            } else {
                chatMessages.appendChild(messageDiv);
            }
            
            scrollToBottom();
            
            // Simulate message status updates for sent messages
            if (isSent) {
                setTimeout(() => updateMessageStatus(messageDiv, 'delivered'), 1000);
                setTimeout(() => updateMessageStatus(messageDiv, 'read'), 3000);
            }
        }

        function updateMessageStatus(messageElement, status) {
            const statusElement = messageElement.querySelector('.message-status i');
            if (statusElement) {
                statusElement.className = `fas fa-check${status === 'read' ? '-double' : ''} status-${status}`;
                statusElement.title = status.charAt(0).toUpperCase() + status.slice(1);
            }
        }

        function simulateResponse(userMessage) {
            const responses = [
                "That sounds great!",
                "Perfect! Let me check with my team and get back to you.",
                "Would next week work for you?",
                "I'll send you the details shortly.",
                "Thanks for the quick response!",
                "Let's schedule a call to discuss this further.",
                "I'm excited about this opportunity!",
                "Could you share more details about the timeline?",
                "That works perfectly for me.",
                "I'll prepare the documents and send them over."
            ];
            
            // Choose response based on user message context
            let response;
            const lowerMessage = userMessage.toLowerCase();
            
            if (lowerMessage.includes('when') || lowerMessage.includes('time') || lowerMessage.includes('schedule')) {
                response = "How about tomorrow at 3 PM? I'll send you a calendar invite.";
            } else if (lowerMessage.includes('salary') || lowerMessage.includes('compensation')) {
                response = "The salary range is competitive and we're open to negotiation based on your experience.";
            } else if (lowerMessage.includes('thank')) {
                response = "You're welcome! Looking forward to working together.";
            } else {
                response = responses[Math.floor(Math.random() * responses.length)];
            }
            
            addMessage(response, false);
            
            // Update conversation preview with bot response
            updateConversationPreview(currentChatId, response);
        }

        function showTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            typingIndicator.style.display = 'flex';
            scrollToBottom();
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            typingIndicator.style.display = 'none';
        }

        function handleTyping() {
            if (!isTyping) {
                isTyping = true;
                // In real app, send typing status to server
                console.log('üë§ User started typing...');
            }
            
            // Clear previous timeout
            if (typingTimeout) {
                clearTimeout(typingTimeout);
            }
            
            // Stop typing after 2 seconds of inactivity
            typingTimeout = setTimeout(() => {
                isTyping = false;
                console.log('üë§ User stopped typing');
            }, 2000);
        }

        function selectConversation(chatId, element) {
            currentChatId = chatId;
            
            // Update active conversation
            document.querySelectorAll('.conversation-item').forEach(item => {
                item.classList.remove('active');
            });
            element.classList.add('active');
            
            // Update chat header
            const chat = chatData[chatId];
            document.getElementById('contactAvatar').textContent = chat.avatar;
            document.getElementById('contactName').textContent = chat.name;
            
            // Clear messages and load new conversation
            loadConversation(chatId);
            
            // Remove unread badge
            const unreadBadge = element.querySelector('.unread-badge');
            if (unreadBadge) {
                unreadBadge.remove();
            }
            
            // Close sidebar on mobile
            if (window.innerWidth <= 768) {
                closeChatSidebar();
            }
            
            console.log(`üí¨ Switched to conversation with ${chat.name}`);
        }

        function loadConversation(chatId) {
            const chatMessages = document.getElementById('chatMessages');
            
            if (chatId === 1) {
                // Keep existing messages for demo
                return;
            }
            
            // Clear messages for other chats
            chatMessages.innerHTML = `
                <div class="message-bubble received">
                    <div class="message-content">Hello! Thanks for connecting with us.</div>
                    <div class="message-time">Today 10:00 AM</div>
                </div>
                <div class="message-bubble sent">
                    <div class="message-content">Hi! Thank you for the opportunity.</div>
                    <div class="message-time">Today 10:05 AM</div>
                    <div class="message-status">
                        <i class="fas fa-check-double status-read" title="Read"></i>
                    </div>
                </div>
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            
            scrollToBottom();
        }

        function updateConversationPreview(chatId, message) {
            const conversationItem = document.querySelector(`[data-chat-id="${chatId}"]`);
            if (conversationItem) {
                const preview = conversationItem.querySelector('.conversation-preview');
                const time = conversationItem.querySelector('.conversation-time');
                
                preview.textContent = message.substring(0, 50) + (message.length > 50 ? '...' : '');
                time.textContent = 'Just now';
                
                // Move conversation to top
                const conversationList = document.querySelector('.conversation-list');
                conversationList.insertBefore(conversationItem, conversationList.firstChild);
            }
        }

        function scrollToBottom() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // Chat sidebar functions
        function toggleChatSidebar() {
            const sidebar = document.getElementById('chatSidebar');
            chatSidebarOpen = !chatSidebarOpen;
            
            if (chatSidebarOpen) {
                sidebar.classList.add('open');
            } else {
                sidebar.classList.remove('open');
            }
        }

        function closeChatSidebar() {
            const sidebar = document.getElementById('chatSidebar');
            sidebar.classList.remove('open');
            chatSidebarOpen = false;
        }

        // Chat action functions
        function startNewChat() {
            showNotification('üìù New chat feature coming soon!', 'info');
        }

        function searchMessages() {
            showNotification('üîç Message search coming soon!', 'info');
        }

        function openChatSettings() {
            showNotification('‚öôÔ∏è Chat settings coming soon!', 'info');
        }

        function startVoiceCall() {
            showNotification('üìû Voice call feature coming soon!', 'info');
        }

        function startVideoCall() {
            showNotification('üìπ Video call feature coming soon!', 'info');
        }

        function showChatInfo() {
            showNotification('‚ÑπÔ∏è Chat info panel coming soon!', 'info');
        }

        function attachFile() {
            showNotification('üìé File attachment coming soon!', 'info');
        }

        function addEmoji() {
            const messageInput = document.getElementById('messageInput');
            const emojis = ['üòä', 'üëç', '‚ù§Ô∏è', 'üéâ', 'üëè', 'üöÄ', 'üí™', 'üî•'];
            const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
            messageInput.value += randomEmoji;
            messageInput.focus();
            
            // Update send button state
            const sendButton = document.getElementById('sendButton');
            const hasText = messageInput.value.trim().length > 0;
            sendButton.disabled = !hasText;
            sendButton.style.opacity = hasText ? '1' : '0.5';
        }

        function loadChatData() {
            // Simulate loading chat data
            console.log('üíæ Loading chat data...');
            
            // In real app, this would load from API
            setTimeout(() => {
                console.log('‚úÖ Chat data loaded');
            }, 500);
        }

        // Utility notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#10B981' : type === 'error' ? '#EF4444' : '#3B82F6'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 0.5rem;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-weight: 500;
                max-width: 350px;
                animation: slideInRight 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Handle responsive behavior
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                closeChatSidebar();
            }
        });

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(e) {
            if (window.innerWidth <= 768 && 
                chatSidebarOpen && 
                !e.target.closest('.chat-sidebar') && 
                !e.target.closest('[onclick*="toggleChatSidebar"]')) {
                closeChatSidebar();
            }
        });

        console.log('üí¨ Chat system fully loaded and functional!');
    </script>
</body>
</html>
